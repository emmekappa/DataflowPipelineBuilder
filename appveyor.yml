version: 1.0.{build}-{branch}
image: 
  - Ubuntu1804
  #- Visual Studio 2017

#build:
#  publish_nuget: true
#  publish_nuget_symbols: true
#  include_nuget_references: true
#  verbosity: minimal

dotnet_csproj:
  patch: true
  file: '**\*.csproj'
  version: '{version}'
  package_version: '{version}'
  assembly_version: '{version}'
  file_version: '{version}'
  informational_version: '{version}'
  
before_build:
  - ps: dotnet restore
    
after_build:
  - ps: >- 
        if ($env:APPVEYOR_REPO_TAG -eq "true") {
          dotnet pack .\DataflowPipelineBuilder -o ..\Artifacts
        } 
        else {
          dotnet pack .\DataflowPipelineBuilder -o ..\Artifacts --version-suffix $env:APPVEYOR_REPO_BRANCH
        }

#artifacts:
#  - path: Artifacts\*
    
deploy_script:
  - ps: appveyor PushArtifact Artifacts\*.nupkg
    
# settings are the same for  both Nuget providers, except "on:" condition
#deploy:
#  - provider: NuGet
#    on:
#      branch: master
#      
#  - provider: NuGet
#    on:
#      appveyor_repo_tag: true